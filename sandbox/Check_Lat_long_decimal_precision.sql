SELECT 
[samp_classdate],
 [corr_classdate], 
 site_obsdate,
 p.[pedlabsampnum]
 siteobjupdate,
 SSL_classdate
 ,[pedoniid]
 ,[upedonid]
 ,CASE WHEN [corr_name] IS NULL THEN [samp_name] ELSE [corr_name] END AS soil_name
,CASE WHEN LEN(RTRIM(REPLACE(STR(latitude_decimal_degrees,15,10),'0',' '))) - 5 + LEN(RTRIM(REPLACE(STR(longitude_decimal_degrees,15,10),'0',' '))) - 5 <= 6 THEN 'x' END AS precision_flag
 , CASE WHEN  p.[pedlabsampnum] IN ('91P0192','93P0234','93P0232','01N0293','87P0540','87P0541','87P0542','87P0543','83P0590','98P0356','40A3251','00P0185','01P0534','01P0535','01P0536','01P0537','01P0538','01P0539','01P0540','01P0541','01P0542','01P0543','01P0544','01P0545','99P0612','99P0613','99P0614','99P0615','99P0616','99P0617','96P0239','81P0321','00P0095','02N0101','84P0753','83P0866','69C0101','00P0001','00P0002','00P0003','00P0004','00P0005','00P0021','00P0022','00P0023','00P0024','00P0025','99P0154','99P0158','96P0169','99P0552','91P0101','87P0522','95P0896','01P0135','92P1072','92P1076','92P1075','92P1074','92P1081','78P0024','02N0105','98P0064','00P0317','89P0379','00P1354','90P0949','99P0224','89P0709','87P0677','92P0334','84P0671','89P0519','00P0034','96P0298','98P0065','01P0163','01P0164','92P0439','95P0895','87P0704','00P0239','00P0052','84P0878','90P0732','94P0260','84P0727','92P1056','00P0041','00P0193','00P0362','98P0097','87P0103','02N0107','96P0281','96P0290','96P0291','96P0282','96P0283','96P0294','96P0284','96P0285','96P0286','96P0287','96P0288','96P0289','95P0918','02N0104','88P0681','00P0190','00P0295','00P0296','00P0297','00P0298','00P0299','00P0300','00P0301','00P0302','00P0303','00P0304','00P0309','00P0310','00P0311','00P0312','00P0339','00P0340','00P0341','00P0342','00P0344','00P0345','00P0346','00P0347','00P0350','00P0352','00P0353','00P0354','00P0355','00P0356','00P0357','00P0358','00P0359','00P0360','00P0363','00P0364','00P0365','00P0366','00P0367','00P0368','00P0369','00P0677','00P0682','81P0063','88P0831','97P0511','97P0487','97P0488','97P0489','97P0490','97P0491','97P0492','97P0493','97P0485','97P0494','97P0495','97P0496','97P0497','97P0498','97P0499','97P0486','97P0500','92P1050','99P0559','84P0553','99P0164','99P0165','00P0026','00P0027','00P0028','00P0029','00P0942','01N0102','01N0103','01N0104','01N0105','01N0106','98P0352','98P0590','87P0576','00P0055','00P0175','00P0045','00P0186','00P0191','00P0192','00P0195','87P0072','96P0028','99P0119','92P1051','81P0770','98P0554','98P0556','00P0351','00P0370','98P0260','02N0108','78P0595','84P0788','97P0465','00P0308','02N0043','02N0044','02N0045','02N0046','02N0047','02N0048','02N0049','02N0050','02N0051','02N0052','02N0053','01N0907','01N0908','01N1135','01N1136','02N0138','02N0139','02N0140','89P0757','01N0114','98P0353','00P1366','00P1367','00P1368','92P0463','98P0555','01P0087','92P0073','97P0390','01N1176','96P0175','96P0177','98P0358','96P0307','96P0306','96P0308','99P0558','99P0144','99P0149','87P0432','88P0734','91P0934','02N0102','96P0171','00P0054','00P0174','87P0303','40A2514','40A3158','88P0048','02N0635','78P0427','01N0172','89P0822','90P0791','94P0052','94P0049','87P0172','93P0507','02N1045','02N1046','02N1047','02N1050','02N1053','03N0122','03N0123','03N0247','03N0248','03N0249','03N0250','03N0890','03N0987','03N0988','03N0989','03N0990','03N0991','03N0992','03N0993','04N0107','04N0108','04N0109','04N0110','04N0111','04N0112','04N0113','04N0114','04N0115','04N0116','04N0117','04N0118','04N0119','04N0120','04N0121','04N0122','04N0123','04N0124','04N0125','04N0126','04N0127','04N0128','04N0129','04N0130','04N0131','04N0132','04N0216','04N0217','04N0252','04N0254','04N0255','04N0402','04N0403','04N0404','04N0408','04N0409','04N0498','04N0499','04N0500','04N0501','04N0590','04N0591','04N0592','04N0593','04N0594','04N0595','04N0596','04N0597','04N0598','04N0599','04N0600','04N0601','04N0602','04N0603','04N0604','04N0605','04N0606','04N0607','04N0608','04N0609','04N0610','04N0611','04N0612','04N0613','04N0614','04N0615','04N0626','04N0627','04N0628','04N0629','04N0630','04N0631','04N0632','04N0633','04N0634','04N0635','04N0636','04N0637','04N0638','04N0639','04N0640','04N0641','04N0642','04N0643','04N0644','04N0645','04N0646','04N0647','04N0648','04N0649','04N0650','04N0651','04N0652','04N0653','04N0654','04N0655','04N0656','04N0657','04N0658','04N0659','04N0660','04N0661','04N0662','04N0663','04N0664','04N0774','04N0775','04N0776','04N0777','04N0778','04N0779','04N0780','04N0825','04N0942','04N0943','04N0944','04N0945','04N0946','04N0947','04N0948','04N0949','04N0950','04N0951','04N0952','04N0953','04N0954','04N0955','04N0956','04N0957','04N0976','04N0977','04N0978','04N0979','04N0980','04N0981','04N0982','04N0983','04N0984','04N0985','04N0986','04N0987','04N0988','04N0989','04N0990','04N0991','04N0992','04N1029','04N1030','04N1031','04N1032','04N1033','04N1034','04N1035','04N1153','04N1154','04N1155','04N1156','04N1157','05N0109','05N0110','05N0111','05N0112','05N0416','05N0417','05N0418','05N0419','05N0547','05N0548','05N0549','05N0550','05N0551','05N0552','05N0581','05N0582','05N0583','05N0584','05N0585','05N0586','05N0587','05N0588','05N0589','05N0662','05N0663','05N0664','05N0665','05N0666','05N0667','05N0668','05N0669','05N0671','05N0672','05N0877','05N0878','05N0879','05N0880','05N0881','05N0882','05N0883','05N0884','05N0885','06N0242','06N0243','06N0244','06N0245','06N0246','06N0247','06N0248','06N0249','06N0250','06N0251','06N0252','06N0253','06N0256','06N0667','06N0668','06N0669','06N0670','06N0671','06N0672','06N0673','06N0674','06N0675','06N0676','06N0678','06N0679','06N0680','06N0681','06N0682','06N0683','06N0684','06N0701','06N0706','06N0830','06N0831','81P0034','81P0052','83P0357','86P0515','86P0705','88P0490','90P0379','94P0266','90P0849','90P0849','90P1087','06N1116','06N1117','06N1118','01N0951','40A2008','90P1090','84P0211','93P0748','87P0455','87P0456','87P0457','87P0458','87P0459','91P0529','99P0556','95P0902','01N0140','99P0229','00P0246','00P1224','96P0170','91P0868','89P0823','99P0166','99P0167','99P0168','98P0557','82P0398','99P0562','96P0295','89P0399','87P0321','99P0162','00P0502','96P0180','98P0354','90P0802','99P0163','00P0503','01N0548','99P0566','00P0405','00P0406','99P0565','99P0554','00P0202','90P0600','95P0904','00P0187','00P0306','00P0307','96P0168','99P0557','00P0200','00P0204','83P0383','99P0560','88P0718','40A3236','91P0148','84P0499','88P0049','88P0050','88P0051','88P0052','88P0053','96P0172','91P0938','00P0006','00P0007','00P0008','00P0009','00P0010','00P0016','00P0017','00P0018','00P0019','00P0020','00P0030','00P0031','00P0032','00P0033','00P0199','00P0203','00P0943','01N0094','01N0095','01N0097','01N0098','01N0099','01N0100','01N0101','01N0107','01N0108','01N0109','01N0110','01N0111','01N0115','98P0351','00P0092','87P0596','00P1318','00P1319','00P1320','00P1321','00P1322','00P1323','00P1325','00P1327','97P0105','88P0713','87P0298','82P0820','01P0562','83P0694','00P0321','85P0960','93P0401','97P0471','02N0106','02N0109','00P0240','98P0362','92P0368','93P0271','78P0589','00P0243','98P0553','01N0112','00P0765','92P0389','95P0903','02N0100','89P0645','92P0597','92P0595','90P0975','99P0563','00P0044','00P0735','00P0936','00P1378','88P0524','88P0525','88P0526','88P0527','00P0188','00P0319','00P0320','78P0030','00P0093','00P0097','00P0098','00P0099','90P0911','98P0067','00P0194','01P0134','01P0133','96P0167','01N0916','01N0113','96P0173','98P0357','00P0313','00P0314','88P0249','88P0250','88P0251','88P0252','88P0253','00P0058','00P1369','00P1370','00P1371','00P1365','88P0862','99P0169','92P0119','87P0647','02N0098','02N0099','84P0752','86P1002','89P0658','89P0659','89P0660','87P0047','00P0011','00P0012','00P0013','00P0014','00P0015','00P0201','01N0093','98P0355','99P0553','00P0198','92P0198','00P0035','98P0066','40A3248','92P0092','92P0093','92P0094','92P0095','92P0099','92P0101','92P0100','97P0472','85P0772','00P0043','00P0349','00P0091','99P0561','02N0103','86P0903','00P0046','40A1973','00P0401','00P0402','00P0403','00P0404','01P0165','01P0166','97P0466','00P1375','00P1376','00P1377','01N0096','80P0228','00P0315','00P0316','00P0094','01N0940','87P0492','87P0493','87P0494','96P0174','00P1372','00P1373','00P1374','98P0552','97P0394','97P0393','00P0305','96P0178','00P0318','00P0096','88P0493','88P0494','88P0495','88P0496','88P0497','96P0176','92P0042','00P0189','99P0555','95P0900','00P0042','88P0646','88P0647','88P0648','88P0649','88P0650','95P0938','88P0152','88P0153','88P0154','88P0155','88P0156','90P1083','91P0141','78P0153','01N1055','81P0822','88P0218','93P0007','86P0590','85P0234','87P0571','92P0769','78P0381','78P0349','93P0700','84P0546','90P0843','01N0472','87P0426','85P0963','01N1154','86P0559','79P0338','90P0801','81P0760','80P0352','78P0515','89P0046','01N1141','02N0666','02N0667','01P0241','01P0242','01P0243','01P0244','01N0569','81P0773','89P0526','83P0762','92P0596','01N0355','01N0565','87P0268','01N1137','01N1144','01N1147','01N1152','79P0242','85P0652','86P0106','81P0291','01N1145','82P0272','87P0271','82P0322','97P0254','01N1139','01N1142','01N1146','01N1153','89P0661','03N0151','01N1184','01N1187','01N1190','01N1193','01N1203','83P0880','01N1056','01N1059','92P0623','01N0471','80P0229','02N1018','01N0572','01N0573','01N1140','01N1148','01N1150','01N1155','01N1156','01N0949','01N1057','01N0947','01N1036','01N0167','01N1138','01N1143','01N1149','01N1151','01N0950','02N0634','89P0652','89P0536','83P0881','01N0473','01N0952','94P0702','01N0571','01N0574','01N1042','01N0946','01N0356','74C0159','03N0159','01N0945','01N0948','02N1015','78P0563','87P0270','92P0627','02N1014','01N1179','01N1196','01N1197','01N1200','83P0867','01N0331','83P0791','01N1183','01N0953','01N0944','01N0791','01N0896','02N0081','02N0529','02N0530','02N0531','02N0532','02N0533','03N0747','03N0748','03N0749','02N0820','02N0821','02N0822','02N0823','02N0824','02N0825','02N0232','02N0233','03N0787','03N0009','04N0188','04N0189','04N0190','04N0191','04N0192','04N0193','04N0194','04N0195','04N0196','04N0197','04N0198','04N0199','04N0200','04N0201','04N0202','04N0203','04N0204','01N1167','01N1168','01N1169','01N1170','01N1171','01N1172','01N1173','02N0291','02N0292','01N1160','01N1159','01N1165','02N1112','02N1114','02N1118','02N1119','02N1124','02N1125','02N1126','02N1116','02N1115','02N1113','02N1117','02N1129','02N1131','02N1130','02N1120','02N1121','02N1127','02N1128','02N1122','02N1123','03N0075','03N0076','03N0911','03N0912','03N0916','03N0921','03N0917','03N0918','03N0919','03N0922','03N0920','03N0915','03N0914','03N0913','04N0770','04N0771','04N0772','78P0157','78P0155','78P0156','78P0154','78P0152','78P0151','78P0149','78P0150','98P0147','98P0148','98P0149','98P0150','98P0151','98P0152','98P0153','98P0154','04N0553','04N0552','40A1377','40A1381','40A1382','04N0504','01N0583','01N0586','01N1058','01N1060','01N1061','01N1062','01N1063','01N1064','01N1065','01N1066','02N0166','02N0333','02N0334','02N0598','02N0599','02N0600','02N0601','02N0602','02N0603','02N0604','02N0605','02N0606','02N0607','02N0608','02N0609','02N0610','02N1016','02N1017','02N1019','02N1020','02N1021','02N1022','02N1023','02N1024','02N1025','02N1026','02N1027','02N1043','02N1044','06N0834','06N0835','06N0836','06N0837','06N0838','06N0839','06N0840','06N0898','06N0899','06N0900','06N0901','06N0902','06N0903','06N0904','06N0905','06N0906','06N0907','06N0908','06N0909','06N0910','06N0911','06N0912','06N1044','06N1045','06N1046','06N1047','06N1048','06N1049','06N1050','06N1051','06N1052','06N1053','06N1054','06N1055','06N1056','06N1057','06N1095','06N1096','06N1097','06N1098','06N1099','06N1100','06N1101','06N1102','06N1103','06N1104','06N1108','06N1109','06N1110','06N1111','06N1112','06N1113','06N1114','06N1115','07N0080','07N0081','07N0082','07N0083','07N0084','07N0378','07N0400','80P0185','80P0240','80P0242','80P0244','87P0441','87P0561','87P0563','87P0566','87P0570','87P0625','87P0627','87P0628','89P0598','89P0599','92P0153','92P0154','92P0159','92P0160','92P0575','94P0586','94P0587','94P0588','94P0589','96P0315','96P0337','96P0338','96P0339','96P0340','98P0160','98P0162','98P0163','98P0164','98P0165','98P0166','99P0277','99P0278','99P0279','79P0162','88P0142','03N1007','03N1008','03N1009','03N1010','03N1011','03N1012','03N1013','03N1014','03N1015','03N1016','03N1017','03N1018','03N1019','05N0254','05N0738','05N0739','05N0744','05N0745','05N0780','05N0781','05N0782','07N0375','07N0376','07N0377','07N0078','07N0079','06N0934','06N0529','06N0530','06N0531','06N0532','06N0533','06N0534','06N0535','06N0536','03N0697','03N0698','03N0699','03N0700','03N0701','03N0702','03N0706','03N0707','03N0708','05N0252','05N0253','07N0772','07N0773','07N0774','07N0775','07N0776','07N0777','07N0778','07N0779','07N0780','08N0091','02N0145','02N0146','02N0147','02N0148','02N0149','02N0150','05N0370','05N0371','05N0372','05N0375','05N0376','01N0364','01N0367','01N0368','04N1103','04N1105','04N1089','04N1090','08N0096','08N0099','08N0100','08N0172','08N0173','08N0174','08N0175','07N0796','07N0797','07N0798','07N0799','08N0269','08N0111','08N0112','08N0113','08N0114','08N0115','08N0116','08N0117','08N0118','08N0119','08N0120','08N0121','08N0122','08N0123','08N0124','08N0125','08N0126','08N0127','08N0128','08N0129','08N0130','08N0131','08N0132','08N0133','07N0726','07N0727','07N0728','07N0729','07N0730','07N0731','07N0732','07N0733','07N0734','07N0735','07N0736','07N0737','07N0738','07N0739','07N0740','07N0741','07N0742','07N0743','07N0744','07N0745','07N0746','07N0747','07N0748','08N0149','08N0242','08N0243','08N0244','08N0245','08N0332','08N0333','08N0334','08N0177','08N0178','08N0179','08N0217','08N0218','08N0219','08N0220','08N0221','08N0222','08N0223','08N0224','08N0225','08N0226','08N0227','08N0228','08N0229','08N0230','08N0231','08N0232','08N0640','08N0641','08N0642','08N0643','08N0644','08N0645','08N0646','08N0647','08N0648','08N0649','08N0418','08N0419','08N0420','08N0421','08N0422','08N0423','08N0424','08N0425','08N0426','08N0427','08N0428','08N0429','08N0430','08N0431','08N0432','08N0409','08N0410','08N0488','08N0489','08N0490','08N0491','08N0492','08N0493','08N0494','08N0495','08N0470','08N0471','08N0472','08N0473','08N0474','08N0475','08N0435','08N0436','08N0437','08N0438','08N0439','08N0440','08N0441','08N0442','08N0443','08N0444','08N0262','08N0263','08N0264','08N0265','08N0266','08N0267','08N0268','08N0248','08N0249','08N0250','08N0251','08N0252','08N0253','08N0254','08N0255','08N0256','08N0257','08N0258','08N0259','08N0336','08N0261','08N0623','82P0044','85P0667','87P0215','88P0084','85P0316','88P0108','88P0797','88P0799') THEN 'Centroid' END AS centroid_flag


 
      ,[siteiid]
      ,[usiteid]
      ,[site_obsdate]
	,  LEN (  [latitude_decimal_degrees]) AS len_lat
	,  LEN (  [longitude_decimal_degrees]) AS len_long
 ,LEN(RTRIM(REPLACE(STR(latitude_decimal_degrees,15,10),'0',' '))) - 5 AS decimal_length_lat
 ,LEN(RTRIM(REPLACE(STR(longitude_decimal_degrees,15,10),'0',' '))) - 5 AS decimal_length_long
 ,LEN(RTRIM(REPLACE(STR(latitude_decimal_degrees,15,10),'0',' '))) - 5 + LEN(RTRIM(REPLACE(STR(longitude_decimal_degrees,15,10),'0',' '))) - 5 AS decimal_length_lat_long_total
      ,[latitude_decimal_degrees]
      ,[longitude_decimal_degrees]
        ,country_code
        ,country_name
       , state_code
       , state_name
       , county_code
       , county_name
       , mlra_code
       , mlra_name
       , ssa_code
       , ssa_name

      ,[pedobjupdate]

FROM  [lab_pedon] AS p 
INNER JOIN  [lab_combine_nasis_ncss] AS cnn ON p.pedon_key=cnn.pedon_key 
INNER JOIN (SELECT [area_code] AS country_code,[area_name] AS country_name, area_key FROM lab_area -- Country
) AS c ON cnn.[country_key]=c.area_key
LEFT OUTER JOIN  (SELECT [area_code] AS state_code,[area_name] AS state_name, area_key FROM lab_area --State
) AS s ON cnn.[state_key]=s.area_key 
 
LEFT OUTER JOIN  (SELECT [area_code] AS county_code,[area_name] AS county_name, area_key FROM lab_area --County
) AS ct ON cnn.[county_key]=ct.area_key
 
LEFT OUTER JOIN  (SELECT [area_code] AS mlra_code,[area_name] AS mlra_name, area_key FROM lab_area --MLRA
) AS m ON cnn.[mlra_key]=m.area_key
LEFT OUTER JOIN (SELECT [area_code] AS ssa_code,[area_name] AS ssa_name, area_key FROM lab_area --SSA
) AS ss ON cnn.[ssa_key]=ss.area_key
WHERE [latitude_decimal_degrees] IS NOT NULL
 
