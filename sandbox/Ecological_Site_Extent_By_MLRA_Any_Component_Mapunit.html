<!DOCTYPE HTML>
<html>
<head>
 <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
	<title>NRCS Ecological Site Extent</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
</head>
<style type="text/css">

<style>

<style type="text/css">

<style>

<style type="text/css">
        .scrolltable {
            overflow-x: scroll;
            height: 100%;
            display: flex;
            display: -webkit-flex;
            flex-direction: column;
            -webkit-flex-direction: column;
        }
        .scrolltable > .header {
        }
        .scrolltable > .body {
            /*noinspection CssInvalidPropertyValue*/
            width: -webkit-fit-content;
            overflow-y: scroll;
            flex: 1;
            -webkit-flex: 1;
        }
        th, td {
            min-width: 25px;
        }
        /* an outside constraint to react against */
        #constrainer {
            width: 400px;
            height: 200px;
        }
        #constrainer2 {
            width: 400px;
            overflow-x: scroll;
        }
        #constrainer2 table {
            overflow-y: scroll;
        }
        #constrainer2 tbody {
            overflow-x: scroll;
            display: block;
            height: 200px;
        }
        #constrainer2 thead {
            display: table-row;
        }
        /* only styling below here */
        #constrainer, #constrainer2 {
            border: 1px solid lightgrey;
        }
        table {
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid gray;
        }
        th {
            background-color: lightgrey;
            border-width: 1px;
        }
        td {
            border-width: 1px;
        }
        tr:first-child td {
            border-top-width: 0;
        }
        tr:nth-child(even) {
            background-color: #eee;
        }
    </style>



<body>
<!--<img src="https://websoilsurvey.sc.egov.usda.gov/App/Resources/HomePage/images/WSSMasthead4.png" alt="WSS Logo" style="width:650px;height:150px;"> -->



	<h3>Soil Data Access (SDA) Ecological Site Extent</h3>
	<p>
	An SDA-populated select list is used to pick a state and SSA which enables creation of a "Ecological Site Extent Report" based upon those selections. First select the  MLRA. This will call a list of Ecological Sites that occur within that MLRA. The second selection selects the ecological site. This will look for any component in a map unit and list all map units that are linked to that ecological site  The data is not static; it hits Soil Data Access Live. 
	<a href='#reportref'> For more information about the table, </a>
	</p>
	<a name='top'>
	<!-- The following "div" tag will be updated with the retrieved data
		After the first selection the "(select a state)" will disappear -->
	<select id="selectId1" onchange="ChangeSelectedState(event)">
		<option value='' style="display: none" id="remove">(select a MLRA)</option>
	</select>
	
	<div id="selectedmlraid"><p>(no MLRA selected)</p></div>
	
	<select id="selectId2" onchange="ChangeSelectedSSA(event)">
		<option value='' style="display: none" id="remove">(select a Ecological Site)</option>
	</select>
	
	<div id="selectedecoid"><p>(no Ecological Site selected)</p></div>
	
	<div class="container" id="id1"></div>
	<br></br>
<h2>
	<b>
		<font color='red'>
			<a name='reportref'>Report Metadata:</a>
		</font>
	</b>
	</h2>
	<php>
		<a href='#top'>Back to top</a>
	</php>
	<h4>Table Columns </h4>
	<ul>
	<li><b>ecoclassid: </b>The identifier of a particular ecological community. For NRCS ecological sites, it is the concatenated form of ecological site type, ecological
site MLRA, ecological site LRU, ecological site number and ecological site state FIPS alpha code.</li>
	<li><b>ecoclassname: </b> The descriptive name of a particular ecological community. For NRCS ecological sites, it is the concatenated form of three or six other
fields. The actual fields that are concatenated together to form this name differ between range and forest ecological sites.</li>
	<li><b>muname: </b> Correlated name of the mapunit (recommended name or field name for surveys in progress).</li>
	<li><b>mukey: </b> A non-connotative string of characters used to uniquely identify a record in the Mapunit table.</li>
	<li><b>musym: </b> The symbol used to uniquely identify the soil mapunit in the soil survey.</li>
	<li><b>nationalmusym: </b> The symbol used to uniquely identify the soil mapunit nationally. The value is generated by NASIS, and is the based on the muiid from the
Mapunit table, expressed in base 36. It is a combination of numberic and lowercase alphabetic characters.</li>
	
	<li><b>areasymbol: </b> A symbol that uniquely identifies a single occurrence of a particular type of area (e.g. Dane Co., Wisconsin is WI025).</li>
	<li><b>areaname :  </b>The name given to the specified geographic area.</li>
		</ul>
<h4>
	Major Land Resource Area Definition (<acronym title="Major Land Resource Area">MLRA</acronym>)</h4>
<p>
	Major land resource areas (<acronym title="Major Land Resource Area">MLRA</acronym>s) are geographically associated land resource units (<acronym title="Land Resource Unit">LRU</acronym>s). Identification of these large areas is important in statewide agricultural planning and has value in interstate, regional, and national planning.</p>
<p>
	The 278 major land resource areas are designated by Arabic numbers and identified by a descriptive geographic name in Agriculture Handbook 296. For example, <acronym title="Major Land Resource Area">MLRA</acronym> 1 (Northern Pacific Coast Range, Foothills, and Valleys) is on the west coast; <acronym title="Major Land Resource Area">MLRA</acronym> 157&nbsp;( Arid and Semiarid Low Mountain Slopes) is in Hawaii; <acronym title="Major Land Resource Area">MLRA</acronym> 227 (Copper River Basin) is in Alaska; <acronym title="Major Land Resource Area">MLRA</acronym> 270 (Humid Mountains and Valleys) is in Puerto Rico; and <acronym title="Major Land Resource Area">MLRA</acronym> 190 (Stratovolcanoes of the Mariana Islands) is in the Pacific Basin.&nbsp; Where preexising <acronym title="Major Land Resource Area">MLRA</acronym>s have been revised, an alphabetic suffix is often added to the original Arabic number (e.g., <acronym title="Major Land Resource Area">MLRA</acronym> 102A, <acronym title="Major Land Resource Area">MLRA</acronym> 102B, and <acronym title="Major Land Resource Area">MLRA</acronym> 102C).</p>
<p>
	The dominant physical characteristics of the major land resource areas are described briefly in Agriculture Handbook 296&nbsp; The first paragraph lists the extent of each <acronym title="Major Land Resource Area">MLRA</acronym> in each state and the total area. Major cities, highways, and culturally significant Federal- and state-owned lands within each <acronym title="Major Land Resource Area">MLRA</acronym> are also listed. The remaining headings for each <acronym title="Major Land Resource Area">MLRA</acronym> include, physiography, geology,&nbsp; climate, water, soils, biological resources, and land use.</p>
<p>
	<i>Physiograph</i>.-Fenneman&#39;s physiographic section, province, and major division (for the conterminous 48 states) making up the <acronym title="Major Land Resource Area">MLRA</acronym> are listed first in this section. The topography of the area, including natural and cultural features, is described.&nbsp; A range in height above sea level and topographic relief, including significant exceptions, if applicable, are provided for the area as a whole.&nbsp; The extent of four-digit Hydrologic Unit Areas and the major rivers in the <acronym title="Major Land Resource Area">MLRA</acronym> are listed.</p>
<p>
	<i>Geology.</i>-Bedrock and surficial geology of each <acronym title="Major Land Resource Area">MLRA</acronym> is described.</p>
<p>
	<em>Climate</em>.-Climatic data for each <acronym title="Major Land Resource Area">MLRA</acronym> was derived by joining digital spatial maps of the <acronym title="Major Land Resource Area">MLRA</acronym> boundaries with 1961-1991 climate data generated using PRISM (Parameter-elevation Regressions on Independent Slopes Model). Climate data provided include: (1) a range of the average annual precipitation for the driest to the wettest parts of the area, (2) the shortest distribution of precipitation, (3) a range of the average annual air temperature, and (4) the shortest, longest, and average length of the frost-free period for each resource area.</p>
<p>
	<em>Water</em>.-United States Geological Survey publications of estimated surface and ground water use and the location of surface and ground water resources in each state were used to prorate water use to each <acronym title="Major Land Resource Area">MLRA</acronym>.&nbsp; The distribution was based on the availability of surface and ground water resources across a State, the quality of the water, and the location of potential users.&nbsp; The total amount of water used is reported as well as the percent supplied from surface and ground water and the percent used for public supply, livestock water, irrigation, and other purposes (domestic, municipal and industrial, mining, and cooling of thermoelectric power plants).&nbsp; Major land resource areas dependent on other areas for water supply and those that furnish water to other areas are also specified.</p>
<p>
	<em>Soils</em>.-Dominant soil moisture and temperature regimes, mineralogy, and texture of the dominant soils within each <acronym title="Major Land Resource Area">MLRA</acronym> were primarily determined by querying <acronym title="Soil Survey Geographic Database">SSURGO</acronym> (Soil Survey Geographic Database). Soils are identified according to the principal suborders, great groups, and representative soil series. Landscape position for the representative soils is typically included.</p>
<p>
	<em>Biological Resources</em>.-Plant species that the major land resource area can support are identified by their common names.&nbsp; Significant fish and wildlife species are also listed.</p>
<p>
	<em>Land use</em>.-National Resources Inventory (NRI) staff used 1997 data to determine land use for most of the major land resource areas. The relative extent of the Federally or privately owned land is indicated. The extent of the land used for cropland (including hayland, range, forest, industrial and urban developments, water, and other special purposes is indicated. These fractions or percentages are for the entire resource area unless specifically stated otherwise. Also included is a list of the principal crops grown and the type of farming practiced. Some of the major soil resource concerns and common conservation practices used to mitigate soil resource land management concerns also are listed for each <acronym title="Major Land Resource Area">MLRA</acronym>.<br />
	&nbsp;</p>
<h3>
	Land Resource Unit (<acronym title="Land Resource Unit">LRU</acronym>) / Common Resource Area (<acronym title="Common Resource Area">CRA</acronym>)</h3>
<p>
	Land resource units (<acronym title="Land Resource Unit">LRU</acronym>s) are the basic units from which major land resource areas (<acronym title="Major Land Resource Area">MLRA</acronym>s) are determined. They are also the basic units for State land resource maps. They are typically coextensive with State general soil map units, but some general soil map units are subdivided into land resource units because of significant geographic differences in climate, water resources, or land use.</p>
<p>
	<a href="/wps/portal/nrcs/detail/soils/survey/geo/?cid=nrcs142p2_053635">Common Resource Areas (<acronym title="Common Resource Area">CRA</acronym>s)</a> are created by subdividing <acronym title="Major Land Resource Area">MLRA</acronym>s by resource concerns, soil groups, hydrologic units, resource use, topography, other landscape features, and human considerations affecting use and treatment needs.&nbsp; The database for the Digital General Soil Map of the U.S. (formerly <acronym title="State Soil Geographic Database">STATSGO</acronym>) is considered useful in subdividing the <acronym title="Major Land Resource Area">MLRA</acronym>. The naming convention for <acronym title="Common Resource Area">CRA</acronym>s is the <acronym title="Major Land Resource Area">MLRA</acronym> symbol, followed by a dot and a numeric code (e.g., 102C.3 or 72.6).&nbsp;<acronym title="Common Resource Area">CRA</acronym> symbols are correlated across State boundaries to ensure a Nationally consistent <acronym title="Common Resource Area">CRA</acronym> legend.&nbsp; A national, digital geographic coverage for <acronym title="Common Resource Area">CRA</acronym>s is presently under development and in some portions of the Nation is associated with the Development of a Common Spatial Framework of Ecological Units, an interagency effort involving eight Federal agencies.</p>
<p>
	<acronym title="Land Resource Unit">LRU</acronym>s have historically only had wide use in the southwestern portion of the U.S., whereas <acronym title="Common Resource Area">CRA</acronym>s are more widely accepted across the nation.</p>


	<script>
		var url =  "HTTPS://sdmdataaccess.sc.egov.usda.gov/tabular/post.rest";
		var mlraid = "";
		// Wait for everything to be loaded before starting the first SDA request
		$(document).ready(function(){
			// Start by retrieving a state list
			var data = {
				//query: "select statename, mlraid from state order by statename;",
				query: "SELECT areasymbol, areasymbol AS mlraid, areaname AS MLRA_Name FROM laoverlap WHERE laoverlap.areatypename ='MLRA' GROUP BY areasymbol ,  areaname ORDER BY areasymbol ASC;",
				
				format: "json"
			}
			$.post(url, data, function( callbackData ) {
					loadSelect("selectId1", callbackData.Table, 1, 0, "select a MLRA");
				}, 
				"json");
		});
		
		function loadSelect(id, table, valueColumn, labelColumn, hintOption) {
			// Add options to the specified select list. The content of the table[valueColumn]
			// defines the value of the selection, the table[labelColumn] is used for the 
			// displayed option's text.
			var iRow = 0;
			$("#" + id)[0].innerHTML = "<option value='' style='display: none' id='remove'>(" + hintOption + ")</option>";
			while (iRow < table.length) {
				var row = table[iRow];
				var optionHtml = "<option value='" + row[valueColumn] + "'>" + row[labelColumn] + "</option>";
				$("#" + id).append(optionHtml);
				iRow++;
			}
		}
		
		function ChangeSelectedState(event) {
			// Update the selected state text area and then fetch SSA names and symbols
			var mlraid = event.target.value;
			var notification = $("#selectedmlraid");
			notification[0].innerHTML = "<p>selected mlraid = " + mlraid + "</p>";
			
				query =
				"SELECT  ecoclassid AS ecoid, ecoclassid, ecoclassname,  lao.areasymbol AS MLRA, lao.areaname AS MLRA_Name, ecoclasstypename,  ecoclassref "
				+ "FROM  legend INNER JOIN laoverlap AS lao ON legend.lkey = lao.lkey AND lao.areasymbol = '" + mlraid + "'" 
				+ "INNER JOIN muaoverlap AS mua ON mua.lareaovkey = lao.lareaovkey AND lao.areatypename='mlra' "
				+ "INNER JOIN mapunit AS mu ON mu.mukey = mua.mukey "
				+ "INNER JOIN component c ON c.mukey = mu.mukey AND compkind = 'series' "
				+ "INNER JOIN coecoclass on c.cokey = coecoclass.cokey and coecoclass.ecoclassref like 'Ecological Site Description Database'"
				+ " GROUP BY lao.areasymbol , lao.areaname, ecoclasstypename, ecoclassid, ecoclassname, ecoclassref  "
				+ "ORDER BY lao.areasymbol ASC, ecoclassid;";

			var data = {
				query: query,
				format: "json"
			}
			
			$.post(url, data, function( callbackData ) {
					loadSelect("selectId2", callbackData.Table, 1, 0, "select an Ecological Site");
				}, 
				"json");
		}
		
		function ChangeSelectedSSA(event) {
			// Update the selected SSA text area and then fetch and display report 2 results
			var ecoid = event.target.value;
			var notification = $("#selectedecoid");
			notification[0].innerHTML = "<p>selected SSA areasymbol = " + ecoid + "</p>";
			
		query = 
				"SELECT lao.areasymbol AS MLRA, lao.areaname AS MLRA_Name,  ecoclassid, ecoclassname, muname, mu.mukey, musym,  nationalmusym, legend.areasymbol, legend.areaname "
					+ " FROM  legend "
					+ "INNER JOIN laoverlap AS lao ON legend.lkey = lao.lkey "
					+ "INNER JOIN muaoverlap AS mua ON mua.lareaovkey = lao.lareaovkey AND lao.areatypename='mlra' "
					+ "INNER JOIN mapunit AS mu ON mu.mukey = mua.mukey INNER JOIN component c ON c.mukey = mu.mukey AND compkind = 'series' "
					+ "INNER JOIN coecoclass on c.cokey = coecoclass.cokey and coecoclass.ecoclassref = 'Ecological Site Description Database' AND ecoclassid = '" + ecoid + "'" 
					+ "GROUP BY lao.areasymbol , lao.areaname, ecoclassid, ecoclassname, muname, mu.mukey, musym,  nationalmusym, legend.areasymbol, legend.areaname  "
					+ "ORDER BY lao.areasymbol ASC, ecoclassid";			
					

			
					var data = {
				query: query,
				format: "json+columnname"
			}
			
			$.post(url, data, function( callbackData ) {
				// the success callback function: when executed add content to table
					$('#id1')[0].innerHTML = "";
					var tableHtml = '<table border="1">';
					// for each row...
		                var iRow = 0;
                while (iRow < callbackData.Table.length) {
                                var row = callbackData.Table[iRow];
                                tableHtml += "<tr>";
                                // for each column in each row...
                                var iCol = 0;
                                while (iCol < row.length) {
                                                if (iRow == 0) {
                                                                tableHtml += "<th>" + row[iCol] + "</th>";
                                                } else {
                                                                tableHtml += "<td>" + row[iCol] + "</td>";
                                                }
                                                iCol++;
                                };
                                tableHtml += "</tr>";                                  
                                iRow++;
                };

					tableHtml += '</table>'
					$('#id1').append(tableHtml);
				}, 
				// Specify that we want the request to be sent in JSON format
				"json");			
			
				
		}
	</script>
	
<script>
$(function(){
	$('table').each(function() {
		if($(this).find('thead').length > 0 && $(this).find('th').length > 0) {
			// Clone <thead>
			var $w	   = $(window),
				$t	   = $(this),
				$thead = $t.find('thead').clone(),
				$col   = $t.find('thead, tbody').clone();

			// Add class, remove margins, reset width and wrap table
			$t
			.addClass('sticky-enabled')
			.css({
				margin: 0,
				width: '100%'
			}).wrap('<div class="sticky-wrap" />');

			if($t.hasClass('overflow-y')) $t.removeClass('overflow-y').parent().addClass('overflow-y');

			// Create new sticky table head (basic)
			$t.after('<table class="sticky-thead" />');

			// If <tbody> contains <th>, then we create sticky column and intersect (advanced)
			if($t.find('tbody th').length > 0) {
				$t.after('<table class="sticky-col" /><table class="sticky-intersect" />');
			}

			// Create shorthand for things
			var $stickyHead  = $(this).siblings('.sticky-thead'),
				$stickyCol   = $(this).siblings('.sticky-col'),
				$stickyInsct = $(this).siblings('.sticky-intersect'),
				$stickyWrap  = $(this).parent('.sticky-wrap');

			$stickyHead.append($thead);

			$stickyCol
			.append($col)
				.find('thead th:gt(0)').remove()
				.end()
				.find('tbody td').remove();

			$stickyInsct.html('<thead><tr><th>'+$t.find('thead th:first-child').html()+'</th></tr></thead>');
			
			// Set widths
			var setWidths = function () {
					$t
					.find('thead th').each(function (i) {
						$stickyHead.find('th').eq(i).width($(this).width());
					})
					.end()
					.find('tr').each(function (i) {
						$stickyCol.find('tr').eq(i).height($(this).height());
					});

					// Set width of sticky table head
					$stickyHead.width($t.width());

					// Set width of sticky table col
					$stickyCol.find('th').add($stickyInsct.find('th')).width($t.find('thead th').width())
				},
				repositionStickyHead = function () {
					// Return value of calculated allowance
					var allowance = calcAllowance();
				
					// Check if wrapper parent is overflowing along the y-axis
					if($t.height() > $stickyWrap.height()) {
						// If it is overflowing (advanced layout)
						// Position sticky header based on wrapper scrollTop()
						if($stickyWrap.scrollTop() > 0) {
							// When top of wrapping parent is out of view
							$stickyHead.add($stickyInsct).css({
								opacity: 1,
								top: $stickyWrap.scrollTop()
							});
						} else {
							// When top of wrapping parent is in view
							$stickyHead.add($stickyInsct).css({
								opacity: 0,
								top: 0
							});
						}
					} else {
						// If it is not overflowing (basic layout)
						// Position sticky header based on viewport scrollTop
						if($w.scrollTop() > $t.offset().top && $w.scrollTop() < $t.offset().top + $t.outerHeight() - allowance) {
							// When top of viewport is in the table itself
							$stickyHead.add($stickyInsct).css({
								opacity: 1,
								top: $w.scrollTop() - $t.offset().top
							});
						} else {
							// When top of viewport is above or below table
							$stickyHead.add($stickyInsct).css({
								opacity: 0,
								top: 0
							});
						}
					}
				},
				repositionStickyCol = function () {
					if($stickyWrap.scrollLeft() > 0) {
						// When left of wrapping parent is out of view
						$stickyCol.add($stickyInsct).css({
							opacity: 1,
							left: $stickyWrap.scrollLeft()
						});
					} else {
						// When left of wrapping parent is in view
						$stickyCol
						.css({ opacity: 0 })
						.add($stickyInsct).css({ left: 0 });
					}
				},
				calcAllowance = function () {
					var a = 0;
					// Calculate allowance
					$t.find('tbody tr:lt(3)').each(function () {
						a += $(this).height();
					});
					
					// Set fail safe limit (last three row might be too tall)
					// Set arbitrary limit at 0.25 of viewport height, or you can use an arbitrary pixel value
					if(a > $w.height()*0.25) {
						a = $w.height()*0.25;
					}
					
					// Add the height of sticky header
					a += $stickyHead.height();
					return a;
				};

			setWidths();

			$t.parent('.sticky-wrap').scroll($.throttle(250, function() {
				repositionStickyHead();
				repositionStickyCol();
			}));

			$w
			.load(setWidths)
			.resize($.debounce(250, function () {
				setWidths();
				repositionStickyHead();
				repositionStickyCol();
			}))
			.scroll($.throttle(250, repositionStickyHead));
		}
	});
});
</script>
</body>
</html>