SELECT NCSS_Pedon_Taxonomy.samp_name AS sampled_taxon_name, NCSS_Layer.labsampnum AS labsampnum1, NCSS_Pedon_Taxonomy.corr_name AS correlated_taxon_name, NCSS_Pedon_Taxonomy.upedonid AS user_pedon_id, NCSS_Layer.hzn_top AS horizon_top_depth, NCSS_Layer.hzn_bot AS horizon_bottom_depth, NCSS_Layer.hzn_desgn AS horizon_designation, PSDA_and_Rock_Fragments.tex_psda AS lab_texture_class, PSDA_and_Rock_Fragments.sand_tot_psa, PSDA_and_Rock_Fragments.silt_tot_psa, PSDA_and_Rock_Fragments.clay_tot_psa, PSDA_and_Rock_Fragments.co3_cly, PSDA_and_Rock_Fragments.silt_f_psa, PSDA_and_Rock_Fragments.silt_c_psa, PSDA_and_Rock_Fragments.sand_vf_psa, PSDA_and_Rock_Fragments.sand_f_psa, PSDA_and_Rock_Fragments.sand_m_psa, PSDA_and_Rock_Fragments.sand_vc_psa, PSDA_and_Rock_Fragments.sand_c_psa, CEC_and_Bases.acid_tea, Carbon_and_Extractions.c_tot, CEC_and_Bases.base_sum, CEC_and_Bases.al_kcl, CEC_and_Bases.cec_nh4, CEC_and_Bases.ecec, CEC_and_Bases.al_sat, ph_and_Carbonates.ph_h2o, ph_and_Carbonates.ph_cacl2, ph_and_Carbonates.gypl20, ph_and_Carbonates.caco3, Salt.ec_12pre, Salt.sar, Phosphorus.p_olsn, Phosphorus.p_nz, Round(([c_tot]-(IIf(IsNull([caco3]),0,[caco3])*0.12)),2)*1.724 AS Est_OM, NCSS_Layer.labsampnum, db.Bulk_Density_and_Moisture.db_13b, db.Bulk_Density_and_Moisture.db_od, db.Bulk_Density_and_Moisture.COLEws, db.Bulk_Density_and_Moisture.w15l2, db.Bulk_Density_and_Moisture.w15cly, db.Bulk_Density_and_Moisture.cec7_cly, ([c_tot]-([caco3]*0.12)) AS Calc_OC, 2.5*([w15l2]-(([c_tot]-([caco3]*0.12)))) AS Calc_Clay, db.Bulk_Density_and_Moisture.wrd_ws13 AS AWC, CEC_and_Bases.bsecat AS basesat8_2, CEC_and_Bases.bsesat AS basesat7, Round(([c_tot]-(IIf(IsNull([caco3]),0,[caco3])*0.12)),2) AS Est_OC, NCSS_Site_Location.latitude_decimal_degrees, NCSS_Site_Location.longitude_decimal_degrees, NCSS_Site_Location.state_name, NCSS_Site_Location.county_code, NCSS_Site_Location.ssa_code, NCSS_Site_Location.mlra_code
FROM NCSS_Site_Location INNER JOIN ((((((((NCSS_Layer LEFT JOIN CEC_and_Bases ON NCSS_Layer.[labsampnum] = CEC_and_Bases.[labsampnum]) LEFT JOIN PSDA_and_Rock_Fragments ON NCSS_Layer.[labsampnum] = PSDA_and_Rock_Fragments.[labsampnum]) LEFT JOIN Carbon_and_Extractions ON NCSS_Layer.[labsampnum] = Carbon_and_Extractions.[labsampnum]) LEFT JOIN ph_and_Carbonates ON NCSS_Layer.[labsampnum] = ph_and_Carbonates.[labsampnum]) LEFT JOIN (SELECT * FROM Bulk_Density_and_Moisture WHERE prep_code In ('S','GP'))  AS db ON NCSS_Layer.[labsampnum] = db.[labsampnum]) LEFT JOIN Salt ON NCSS_Layer.[labsampnum] = Salt.[labsampnum]) LEFT JOIN Phosphorus ON NCSS_Layer.[labsampnum] = Phosphorus.[labsampnum]) INNER JOIN NCSS_Pedon_Taxonomy ON NCSS_Layer.pedon_key = NCSS_Pedon_Taxonomy.pedon_key) ON NCSS_Site_Location.site_key = NCSS_Pedon_Taxonomy.site_key
ORDER BY NCSS_Layer.hzn_master, PSDA_and_Rock_Fragments.tex_psda, NCSS_Layer.pedon_key, NCSS_Layer.hzn_top;
